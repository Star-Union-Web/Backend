{% extends "events/card_temp.html" %}

{% block title %}Events{% endblock %}

{% block card_title %}Events{% endblock %}

{% block card_content %}


<div class="row card-body">
    {% for event in events %}
    <div class="col-md-4 mb-3">
        <div class="card bg-dark text-white text-center">
            <h3 class="card-title bg-primary m-0 p-3">{{event.title}}</h3>
            <div class="card-body px-1 ">
            <p>{{event.description}}</p>
            <p>{{event.start_date}}</p>
            <p>Location: {{event.location}}</p>
            <p>End Date: {{event.end_date}}</p>
            <p>Organizer: {{event.organizer}}</p>
            <p>Capacity: {{event.capacity}}</p>
            </div>




    {% if user == event.organizer or perms.events.admin_event %}

    <div class="d-flex flex-row justify-content-evenly mb-3">
    <a href="{% url 'view_event' event.id %}" class="btn btn-outline-primary">view</a>
    <a href="{% url 'update_event' event.id %}" class="btn btn-outline-secondary">Edit</a>

    <form action="{% url 'delete_event' event.id %}" method="post" style="display:inline;">
        {% csrf_token %}
        <button type="submit" class="btn btn-outline-danger">Delete</button>
    </form>

    {% else %}

        {% if event.capacity %}
            {% if event not in user_events %}
                <form action="{% url 'register_event' event.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-outline-success mb-3">Participate</button>
                </form>
            {% else %}
                <form action="{% url 'delete_attendee' event.id %}" method="post" style="display:inline;">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-outline-dark mb-3">Unregister</button>
                </form>
            {% endif %}

        {% else %}
            <button class="btn btn-outline-dark disabled" >Event full</button>
        {% endif %}
            
    {% endif %}
    </div>
</div>


{% empty %}
<p>No Events Available at the moment</p>
{% endfor %}

            


{% endblock %}